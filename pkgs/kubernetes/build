
url=github
project=kubernetes
version=v1.23.1
checksum=9529d76a623f133fd609765b040382d593c97803220f5166451f0dbca5c807d5
initrd_binaries="/bin/kubelet"

pre_build() {
  cp ../inhibit_linux.go pkg/kubelet/nodeshutdown/systemd/
}

build() {
  export KUBE_LINUX_ARM64_CC=$CC
  export KUBE_LINUX_AMD64_CC=$CC
  export CC=
  export GOARCH=
  export GOFLAGS='-trimpath -tags=providerless,dockerless'
  export KUBE_BUILD_PLATFORMS="linux/${ARCH}"
  hack/make-rules/build.sh cmd/kubelet cmd/kubeadm

  cp _output/local/bin/linux/${ARCH}/* ${BUILD_DIR}/bin/
}
