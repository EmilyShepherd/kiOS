
type=configure
configure_flags="--disable-systemd --enable-embedded-yajl"
depends="lib/libseccomp"

pre_build() {
  export BUILD_CC=$(which gcc)
  export BUILD_LD=$(which ld)

  cd ..
  (cd argp-standalone && build_meson)
  make -C libcap/libcap libcap.a
  cd src

  argp=$(pwd -P)/../argp-standalone
  libcap=$(pwd -P)/../libcap/libcap

  export CFLAGS="$CFLAGS -I${argp} -I${libcap}/include"
  export LDFLAGS="$LDFLAGS -L${argp}/_build -L${libcap}"
}
