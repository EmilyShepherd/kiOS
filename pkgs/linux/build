
version=v5.10
project=torvalds
url=github
checksum=85eaf2c340ff369fefb281ef4afebfc394412b8c0a3b4ff8aadcbe1ebefc3aa4
install_target="zinstall modules_install dtbs_install"
type=make

pre_build() {
  export INSTALL_PATH=${BUILD_DIR}/boot
  export INSTALL_MOD_PATH=${BUILD_DIR}

  mkdir -p $INSTALL_PATH
  rm -rf ${INSTALL_PATH}/*
}

post_build() {
  mkdir -p ${BOOTPART}/kernel
  cp ${INSTALL_PATH}/vmlinuz* ${BOOTPART}/boot/kernel8.img
  cp -r ${BUILD_DIR}/lib/modules ${BOOTPART}/boot/
  find ${INSTALL_PATH} -name '*.dtb' | xargs -I{} cp {} ${BOOTPART}/boot/
}
