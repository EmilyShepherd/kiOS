
version=v5.19
project=torvalds
url=github
checksum=11614fc737638f693d02bf0d95422dfe2b3bcf3088196cd1c4c799cfdf675b70
install_target="zinstall modules_install dtbs_install"
type=make

pre_build() {
  export INSTALL_PATH=${BUILD_DIR}/boot
  export INSTALL_MOD_PATH=${BUILD_DIR}

  mkdir -p $INSTALL_PATH
  rm -rf ${INSTALL_PATH}/*

  if ! test -f .config
  then
    cp ../config .config
  fi
}

post_build() {
  mkdir -p ${BOOTPART}/kernel
  cp ${INSTALL_PATH}/vmlinuz* ${BOOTPART}/boot/kernel8.img
  cp -r ${BUILD_DIR}/lib/modules ${BOOTPART}/boot/
  find ${INSTALL_PATH} -name '*.dtb' | xargs -I{} cp {} ${BOOTPART}/boot/
}
